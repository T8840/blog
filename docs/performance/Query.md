---
title: 查询优化
author: T8840
date: '2023-01-15'
---

## 分析查询执行情况与查询优化
### 查询分析语句

查询分析语句的语法结构是：  
EXPLAIN 查询语句;  



### 查询优化方案
1. 优化查询最有效的方法就是创建索引  
    在包含关键字“LIKE”和“OR”的条件语句中，利用索引提高查询效率。

2. 子查询的执行效率不高，可替换为连接查询  
子查询的执行效率不高。因为MySQL会用临时表把子查询的结果保存起来，然后再使用临时表的内容完成查询。这样一来，查询就多了一个创建临时表的过程，执行效率没有连接查询高。

3. 数据类型优化  
2种方法，一种是针对整数类型数据，尽量使用小的整数类型来定义；另外一种是，如果字段既可以用文本类型，也可以用整数类型，尽量使用整数类型。 

4. 合理增加冗余字段  
在数据量大，而且需要频繁进行连接的时候，为了提升效率，我们也可以考虑增加冗余字段来减少连接。
5. 拆分表  
拆分表的思路是，把1个包含很多字段的表拆分成2个或者多个相对较小的表。  
这样做的原因是，这些表中某些字段的操作频率很高，经常要进行查询或者更新操作，而另外一些字段的使用频率却很低，如果放在一个表里面，每次查询都要读取大记录，会消耗较多的资源。

6. 使用非空约束  
在设计字段的时候，如果业务允许，建议尽量使用非空约束。这样做的好处是，可以省去判断是否为空的开销，提高存储效率。而且，非空字段也容易创建索引。使用非空约束，甚至可以节省存储空间（每个字段1个比特）。




### 千万条记录，分页查询进行优化
如果sql中有1000w条数据，使用
SELECT id,val FROM t_test LIMIT 9000000,10;
需要时间3.s
针对上面语句进行优化：
```sql
# 数据连续时优化语句：
SELECT id,val FROM t_test WHERE id >=9000000 LIMIT 10;
# 或
SELECT id,val FROM t_test WHERE id >=9000000 AND id <9000010;
# 数据不连续时优化语句：
SELECT t.id , t.val FROM t_test t JOIN 
(SELECT id  FROM t_test LIMIT 9000000,10 ） tmp
ON t.id = tmp.id;
```