---
title: 索引
author: T8840
date: '2023-01-15'
---

## 索引定义
索引是存储的表中一个特定列的值数据结构（最常见的是B-Tree）（简化就是，索引包含一个表中特定列的值并保存在一个数据结构中）。索引中除了存储列的值，还存储着一个指向在行数据的索引。  
进行数据库查询时，如果没有索引会进行全表扫描。  
MySQL支持单字段索引和组合索引，而单字段索引比较常用。
### 创建单字段索引
```sql
CREATE INDEX 索引名 ON TABLE 表名 (字段);

CREATE INDEX name_index
ON Employee (Employee_Name);

-- 创建表的同时创建索引
CREATE TABLE 表名
(
字段 数据类型,
….
{ INDEX | KEY } 索引名(字段)
)
-- 修改表时创建索引
ALTER TABLE 表名 ADD { INDEX | KEY } 索引名 (字段);

```
### 单字段索引的作用原理
EXPLAIN关键字能够查看SQL语句的执行细节，包括表的加载顺序，表是如何连接的，以及
索引使用情况等



### 组合索引
组合索引，就是包含多个字段的索引。MySQL最多支持由16个字段组成的组合索引。
如果有多个索引，而这些索引的字段同时作为筛选字段出现在查询中的时候，MySQL会选择使用最优的索引来执行查询操作。
```sql
CREATE INDEX 索引名 ON TABLE 表名 (字段1，字段2，...);

-- 创建表的同时创建索引
CREATE TABLE 表名
(
字段 数据类型,
….
{ INDEX | KEY } 索引名(字段1，字段2，...)
)

-- 修改表时创建索引
ALTER TABLE 表名 ADD { INDEX | KEY } 索引名 (字段1，字段2，...);
```

### 组合索引的原理
组合索引的多个字段是有序的，遵循左对齐的原则。  
如果只用组合索引的一部分，效果没有单字段索引那么好。

### 删除索引
```sql
DROP INDEX 索引名 ON 表名;
-- 有的索引不能用这种方法删除，比如主键索引，你就必须通过修改表来删除索引
ALTER TABLE 表名 DROP PRIMARY KEY；
```


## 其他
- 给表设定主键约束或者唯一性约束的时候，MySQL会自动创建主键索引或唯一性索引。
- 索引可以非常显著地提高数据查询的速度，数据表里包含的数据越多，效果越显著。我们应该选择经常被用做筛选条件的字段来创建索引，这样才能通过索引缩小实际读取数据表中数据的范围，发挥出索引的优势。如果有多个筛选的字段，而且经常一起出现，也可以用多个字段来创建组合索引。
- 索引的成本，2个方面
    1. 存储空间的开销，是指索引需要单独占用存储空间。
    2. 数据操作上的开销，是指一旦数据表有变动，无论是插入一条新数据，还是删除一条旧的
数据，甚至是修改数据，如果涉及索引字段，都需要对索引本身进行修改，以确保索引能
够指向正确的记录。

##  索引是怎么提升性能的？
如果索引使用最常用的数据结构-B-Tree-那么其中的数据是有序的。有序的列值可以极大的提升性能。下面解释原因：假设我们在 Employee_Name这一列上创建一个B-Tree索引。这意味着当我们用之前的SQL查找姓名是‘Jesus’的雇员时，不需要再扫描全表。而是用索引查找去查找名字为‘Jesus’的雇员，因为索引已经按照按字母顺序排序。索引已经排序意味着查询一个名字会快很多，因为名字少字母为‘J’的员工都是排列在一起的。另外重要的一点是，索引同时存储了表中相应行的指针以获取其他列的数据
- 索引的数据结构  
B-Tree 是最常用的用于索引的数据结构。因为它们是时间复杂度低， 查找、删除、插入操作都可以可以在对数时间内完成。另外一个重要原因存储在B-Tree中的数据是有序的。数据库管理系统（RDBMS）通常决定索引应该用哪些数据结构。但是，在某些情况下，你在创建索引时可以指定索引要使用的数据结构

## 索引失效的情况


